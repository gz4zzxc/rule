##### anchor area START #####
x-misc:
  regex-include-info-node: &x-regex-include-info-node '(?i)^â„¹ï¸ .+: \d.+ (KB|MB|GB|TB) \/ \d.+ (KB|MB|GB|TB).*$'
  regex-exclude-info-node: &x-regex-exclude-info-node '(?i)^(?!â„¹ï¸ .+: \d.+ (KB|MB|GB|TB) \/ \d.+ (KB|MB|GB|TB)).*$'

x-dns:
  china: &x-dns-china
    - 119.29.29.29
    - 223.5.5.5
  overseas: &x-dns-overseas
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query

x-proxy-providers: &x-proxy-providers-base
  type: http
  interval: 3600
  health-check:
    enable: true
    url: https://www.gstatic.com/generate_204
    interval: 300

x-proxy-groups:
  control-select-proxy: &x-pg-control-select-proxy
    type: select
    proxies:
      - ğŸ”° èŠ‚ç‚¹é€‰æ‹©
      - ğŸ¯ å…¨éƒ¨ç›´è¿
      - âœˆï¸ æ‰‹åŠ¨é€‰æ‹©
      - ğŸ© ç§æœ‰èŠ‚ç‚¹
      - ğŸ  å®¶å®½èŠ‚ç‚¹
      - ğŸ“¥ é«˜è€—æµé‡
      - ğŸ‡­ğŸ‡° é¦™æ¸¯ä¼˜é€‰
      - ğŸ‡ºğŸ‡¸ ç¾å›½ä¼˜é€‰
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬ä¼˜é€‰
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾ä¼˜é€‰
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡ä¼˜é€‰
      - ğŸ‡°ğŸ‡· éŸ©å›½ä¼˜é€‰

  control-select-direct: &x-pg-control-select-direct
    type: select
    proxies:
      - ğŸ¯ å…¨éƒ¨ç›´è¿
      - ğŸ”° èŠ‚ç‚¹é€‰æ‹©
      - âœˆï¸ æ‰‹åŠ¨é€‰æ‹©
      - ğŸ© ç§æœ‰èŠ‚ç‚¹
      - ğŸ  å®¶å®½èŠ‚ç‚¹
      - ğŸ“¥ é«˜è€—æµé‡
      - ğŸ‡­ğŸ‡° é¦™æ¸¯ä¼˜é€‰
      - ğŸ‡ºğŸ‡¸ ç¾å›½ä¼˜é€‰
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬ä¼˜é€‰
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾ä¼˜é€‰
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡ä¼˜é€‰
      - ğŸ‡°ğŸ‡· éŸ©å›½ä¼˜é€‰

  control-select-private: &x-pg-control-select-private
    type: select
    proxies:
      - ğŸ© ç§æœ‰èŠ‚ç‚¹
      - ğŸ”° èŠ‚ç‚¹é€‰æ‹©
      - ğŸ¯ å…¨éƒ¨ç›´è¿
      - âœˆï¸ æ‰‹åŠ¨é€‰æ‹©
      - ğŸ  å®¶å®½èŠ‚ç‚¹
      - ğŸ“¥ é«˜è€—æµé‡
      - ğŸ‡­ğŸ‡° é¦™æ¸¯ä¼˜é€‰
      - ğŸ‡ºğŸ‡¸ ç¾å›½ä¼˜é€‰
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬ä¼˜é€‰
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾ä¼˜é€‰
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡ä¼˜é€‰
      - ğŸ‡°ğŸ‡· éŸ©å›½ä¼˜é€‰

  control-select-clean: &x-pg-control-select-clean
    type: select
    proxies:
      - ğŸ  å®¶å®½èŠ‚ç‚¹
      - ğŸ”° èŠ‚ç‚¹é€‰æ‹©
      - ğŸ¯ å…¨éƒ¨ç›´è¿
      - âœˆï¸ æ‰‹åŠ¨é€‰æ‹©
      - ğŸ© ç§æœ‰èŠ‚ç‚¹
      - ğŸ“¥ é«˜è€—æµé‡
      - ğŸ‡­ğŸ‡° é¦™æ¸¯ä¼˜é€‰
      - ğŸ‡ºğŸ‡¸ ç¾å›½ä¼˜é€‰
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬ä¼˜é€‰
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾ä¼˜é€‰
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡ä¼˜é€‰
      - ğŸ‡°ğŸ‡· éŸ©å›½ä¼˜é€‰

  control-select-all: &x-pg-control-select-all
    type: select
    include-all: true
    exclude-filter: *x-regex-exclude-info-node

  region-urltest: &x-pg-region-urltest
    type: url-test
    url: "https://www.gstatic.com/generate_204"
    interval: 300
    lazy: true
    include-all: true
    exclude-filter: *x-regex-exclude-info-node

x-rule-providers:
  yaml: &x-rp-yaml
    type: http
    format: yaml
    behavior: classical
    interval: 86400
  text: &x-rp-text
    type: http
    format: text
    behavior: classical
    interval: 86400
  mrs: &x-rp-mrs
    type: http
    format: mrs
    behavior: classical
    interval: 86400
##### anchor area END #####

##### config area START #####
# general
mode: rule
mixed-port: 7890
ipv6: false
allow-lan: true
lan-allowed-ips:
  - 192.168.0.0/16
  - 10.0.0.0/8
  - 172.16.0.0/12
  - 100.64.0.0/10

tun:
  enable: true
  mtu: 1500
  stack: mixed
  auto-route: true
  auto-redirect: true
  auto-detect-interface: true
  dns-hijack:
    - any:53
    - tcp://any:53

profile:
  store-selected: true
  store-fake-ip: true

# meta general
external-controller: 127.0.0.1:9090
unified-delay: true
tcp-concurrent: true
global-client-fingerprint: chrome
geo-auto-update: true
geo-update-interval: 24
geox-url:
  geoip: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  mmdb: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/country.mmdb"
  asn: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/GeoLite2-ASN.mmdb"

# meta sniffer
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - "Mijia Cloud"
    - "+.push.apple.com"

# network stack - dns
dns:
  enable: true
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "+.stun.*.*"
    - "+.stun.*.*.*"
    - "+.stun.*.*.*.*"
    - "+.stun.*.*.*.*.*"
    - "geosite:connectivity-check"
    - "geosite:private"
    - "rule-set:MyDirect"
    - "rule-set:TailscaleDERP_domain"
    - "rule-set:Tailscale_domain"
    - "geosite:tracker"
    - "geosite:category-pt"
    - "geosite:category-games"
    - "rule-set:GoogleVoice"
    - "geosite:category-speedtest"
    - "geosite:category-finance"
    - "rule-set:HongKongBank"
    - "geosite:cn"
  respect-rules: true
  nameserver: *x-dns-overseas
  proxy-server-nameserver: *x-dns-china
  nameserver-policy:
    "geosite:private": *x-dns-china
    "rule-set:MyDirect": *x-dns-china
    "rule-set:TailscaleDERP_domain": *x-dns-china
    "rule-set:Tailscale_domain": *x-dns-china
    "geosite:tracker": *x-dns-china
    "geosite:category-pt": *x-dns-china
    "geosite:category-game-platforms-download": *x-dns-china
    "geosite:category-games@cn": *x-dns-china
    "geosite:category-dev@cn": *x-dns-china
    "geosite:microsoft@cn": *x-dns-china
    "rule-set:AppleCDN": *x-dns-china
    "geosite:cn": *x-dns-china
    "geosite:category-finance": *x-dns-china
    "rule-set:HongKongBank": *x-dns-china
##### config area END #####

# proxy-groups
proxy-groups:
  ## control groups
  - name: â„¹ï¸ è®¢é˜…ä¿¡æ¯
    <<: *x-pg-control-select-all
    filter: *x-regex-include-info-node

  - name: ğŸ”° èŠ‚ç‚¹é€‰æ‹©
    type: select
    proxies:
      - âœˆï¸ æ‰‹åŠ¨é€‰æ‹©
      - ğŸ¯ å…¨éƒ¨ç›´è¿
      - ğŸ© ç§æœ‰èŠ‚ç‚¹
      - ğŸ  å®¶å®½èŠ‚ç‚¹
      - ğŸ‡­ğŸ‡° é¦™æ¸¯ä¼˜é€‰
      - ğŸ‡ºğŸ‡¸ ç¾å›½ä¼˜é€‰
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬ä¼˜é€‰
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾ä¼˜é€‰
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡ä¼˜é€‰
      - ğŸ‡°ğŸ‡· éŸ©å›½ä¼˜é€‰

  - name: âœˆï¸ æ‰‹åŠ¨é€‰æ‹©
    <<: *x-pg-control-select-all

  - name: ğŸ© ç§æœ‰èŠ‚ç‚¹
    <<: *x-pg-control-select-all
    filter: "(?i:Private|PRIV)"

  - name: ğŸ  å®¶å®½èŠ‚ç‚¹
    <<: *x-pg-control-select-all
    filter: "(?i:å®¶å®½|Clean)"

  - name: ğŸ“¥ é«˜è€—æµé‡
    <<: *x-pg-control-select-all
    proxies:
      - ğŸ”° èŠ‚ç‚¹é€‰æ‹©
      - ğŸ¯ å…¨éƒ¨ç›´è¿
      - âœˆï¸ æ‰‹åŠ¨é€‰æ‹©
      - ğŸ© ç§æœ‰èŠ‚ç‚¹
      - ğŸ  å®¶å®½èŠ‚ç‚¹

  - name: ğŸ“¶ Speedtest
    <<: *x-pg-control-select-all
    proxies:
      - ğŸ¯ å…¨éƒ¨ç›´è¿
      - ğŸ”° èŠ‚ç‚¹é€‰æ‹©
      - âœˆï¸ æ‰‹åŠ¨é€‰æ‹©
      - ğŸ© ç§æœ‰èŠ‚ç‚¹
      - ğŸ  å®¶å®½èŠ‚ç‚¹
      - ğŸ“¥ é«˜è€—æµé‡

  - name: ğŸŸ æ¼ç½‘ä¹‹é±¼
    <<: *x-pg-control-select-proxy

  - name: ğŸ¯ å…¨éƒ¨ç›´è¿
    type: select
    hidden: true
    proxies:
      - DIRECT

  ## services groups
  - name: ğŸ Apple
    <<: *x-pg-control-select-direct

  - name: ğŸ­ Google
    <<: *x-pg-control-select-proxy

  - name: â“‚ï¸ Microsoft
    <<: *x-pg-control-select-proxy

  - name: â˜ï¸ Onedrive
    <<: *x-pg-control-select-direct

  - name: ğŸ’» Developer
    <<: *x-pg-control-select-proxy

  - name: âœ¨ GenAI
    <<: *x-pg-control-select-proxy

  - name: ğŸ® Games
    <<: *x-pg-control-select-direct

  - name: ğŸ® Nintendo
    <<: *x-pg-control-select-direct

  - name: ğŸµ Spotify
    <<: *x-pg-control-select-proxy

  - name: ğŸµ Qobuz
    <<: *x-pg-control-select-proxy

  - name: ğŸ¥ Emby Providers
    <<: *x-pg-control-select-all
    filter: "(?i:Emby)"

  - name: ğŸ¥ Youtube
    <<: *x-pg-control-select-proxy

  - name: ğŸ¥ Netflix
    <<: *x-pg-control-select-proxy

  - name: ğŸ¥ Apple TV
    <<: *x-pg-control-select-proxy

  - name: ğŸ¥ TikTok
    <<: *x-pg-control-select-proxy

  - name: ğŸ’¬ Telegram
    <<: *x-pg-control-select-proxy

  - name: ğ• Twitter
    <<: *x-pg-control-select-proxy

  - name: ğŸ’° Crypto
    <<: *x-pg-control-select-proxy

  - name: ğŸ¦ Banking HK
    <<: *x-pg-control-select-direct

  - name: ğŸˆ² Restricted
    <<: *x-pg-control-select-private

  ## region groups
  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯ä¼˜é€‰
    <<: *x-pg-region-urltest
    filter: '(?i)^(?!.*(?:ä¸“ç”¨|noauto))(?=.*(?:ğŸ‡­ğŸ‡°|\bHK[G]?\b|Hong.*?Kong|\bHKT\b|\bHKBN\b|\bHGC\b|\bWTT\b|\bCMI\b|[^-]æ¸¯)).*$'

  - name: ğŸ‡ºğŸ‡¸ ç¾å›½ä¼˜é€‰
    <<: *x-pg-region-urltest
    filter: '(?i)^(?!.*(?:ä¸“ç”¨|noauto))(?=.*(?:ğŸ‡ºğŸ‡¸|\bUS[A]?\b|America|United.*?States|ç¾å›½|[^-]ç¾|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥)).*$'

  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬ä¼˜é€‰
    <<: *x-pg-region-urltest
    filter: '(?i)^(?!.*(?:ä¸“ç”¨|noauto))(?=.*(?:ğŸ‡¯ğŸ‡µ|\bJP[N]?\b|Japan|Tokyo|Osaka|Saitama|æ—¥æœ¬|ä¸œäº¬|å¤§é˜ª|åŸ¼ç‰|[^-å°¼]æ—¥)).*$'

  - name: ğŸ‡¹ğŸ‡¼ å°æ¹¾ä¼˜é€‰
    <<: *x-pg-region-urltest
    filter: '(?i)^(?!.*(?:ä¸“ç”¨|noauto))(?=.*(?:ğŸ‡¹ğŸ‡¼|\bTW[N]?\b|Taiwan|æ–°åŒ—|å½°åŒ–|\bCHT\b|å°æ¹¾|[^-]å°|\bHINET\b)).*$'

  - name: ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡ä¼˜é€‰
    <<: *x-pg-region-urltest
    filter: '(?i)^(?!.*(?:ä¸“ç”¨|noauto))(?=.*(?:ğŸ‡¸ğŸ‡¬|\bSG[P]?\b|Singapore|æ–°åŠ å¡|ç‹®åŸ)).*$'

  - name: ğŸ‡°ğŸ‡· éŸ©å›½ä¼˜é€‰
    <<: *x-pg-region-urltest
    filter: '(?i)^(?!.*(?:ä¸“ç”¨|noauto))(?=.*(?:ğŸ‡°ğŸ‡·|\bK[O]?R\b|Korea|é¦–å°”|éŸ©|éŸ“)).*$'

# rule-providers
rule-providers:
  DstPortDirect:
    <<: *x-rp-text
    behavior: classical
    url: https://testingcf.jsdelivr.net/gh/jimlee2048/atc-config@main/clash/rules/DstPortDirect.list
  AdobeTelemetry:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/ignaciocastro/a-dove-is-dumb@main/pihole.txt
  MyDirect:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/gz4zzxc/rule@main/Clash/list/myCN.list
  MyProxy:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/gz4zzxc/rule@main/Clash/list/foreign.list
  TailscaleDERP_domain:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/jimlee2048/atc-config@main/clash/rules/TailscaleDERP_domain.list
  TailscaleDERP_ip:
    <<: *x-rp-text
    behavior: ipcidr
    url: https://testingcf.jsdelivr.net/gh/jimlee2048/atc-config@main/clash/rules/TailscaleDERP_ip.list
  Tailscale_domain:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/jimlee2048/atc-config@main/clash/rules/Tailscale_domain.list
  Tailscale_ip:
    <<: *x-rp-text
    behavior: ipcidr
    url: https://testingcf.jsdelivr.net/gh/jimlee2048/atc-config@main/clash/rules/Tailscale_ip.list
  ProxyHighBandwidth:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/jimlee2048/atc-config@main/clash/rules/ProxyHighBandwidth.list
  GoogleVoice:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/jimlee2048/atc-config@main/clash/rules/GoogleVoice.list
  Qobuz:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/jimlee2048/atc-config@main/clash/rules/Qobuz.list
  RestrictedZones:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/gz4zzxc/rule@main/Clash/list/fallback.list
  GenAIExtra:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/jimlee2048/atc-config@main/clash/rules/GenAIExtra.list
  CryptoExtra:
    <<: *x-rp-text
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/jimlee2048/atc-config@main/clash/rules/CryptoExtra.list
  HongKongBank:
    <<: *x-rp-text
    behavior: domain
    url: https://fastly.jsdelivr.net/gh/gz4zzxc/rule@main/Clash/rule/HongKongBank.list
  AppleCDN:
    <<: *x-rp-text
    behavior: domain
    url: https://ruleset.skk.moe/Clash/domainset/apple_cdn.txt

# rules
rules:
  # domain > classical > ipcidr
  # 1. local
  - GEOSITE,private,ğŸ¯ å…¨éƒ¨ç›´è¿
  - GEOIP,private,ğŸ¯ å…¨éƒ¨ç›´è¿,no-resolve
  - RULE-SET,DstPortDirect,ğŸ¯ å…¨éƒ¨ç›´è¿
  # 2. block
  - RULE-SET,AdobeTelemetry,REJECT
  # 3. custom override
  - RULE-SET,MyDirect,ğŸ¯ å…¨éƒ¨ç›´è¿
  - RULE-SET,MyProxy,ğŸ”° èŠ‚ç‚¹é€‰æ‹©
  # 4. main: p1
  - RULE-SET,TailscaleDERP_domain,ğŸ¯ å…¨éƒ¨ç›´è¿
  - RULE-SET,Tailscale_domain,ğŸ¯ å…¨éƒ¨ç›´è¿
  - RULE-SET,TailscaleDERP_ip,ğŸ¯ å…¨éƒ¨ç›´è¿,no-resolve
  - RULE-SET,Tailscale_ip,ğŸ¯ å…¨éƒ¨ç›´è¿,no-resolve
  - GEOSITE,tracker,ğŸ¯ å…¨éƒ¨ç›´è¿
  - GEOSITE,category-pt,ğŸ¯ å…¨éƒ¨ç›´è¿
  - GEOSITE,category-speedtest,ğŸ“¶ Speedtest
  - RULE-SET,ProxyHighBandwidth,ğŸ“¥ é«˜è€—æµé‡
  - GEOSITE,category-game-platforms-download,ğŸ¯ å…¨éƒ¨ç›´è¿
  - GEOSITE,category-games@cn,ğŸ¯ å…¨éƒ¨ç›´è¿
  - GEOSITE,category-dev@cn,ğŸ¯ å…¨éƒ¨ç›´è¿
  - GEOSITE,microsoft@cn,ğŸ¯ å…¨éƒ¨ç›´è¿
  - RULE-SET,AppleCDN,ğŸ¯ å…¨éƒ¨ç›´è¿
  # 5. main: p2
  - GEOSITE,bing,ğŸ‡ºğŸ‡¸ ç¾å›½ä¼˜é€‰
  - GEOSITE,onedrive,â˜ï¸ Onedrive
  - RULE-SET,GoogleVoice,ğŸ‡ºğŸ‡¸ ç¾å›½ä¼˜é€‰
  - GEOSITE,telegram,ğŸ’¬ Telegram
  - GEOIP,telegram,ğŸ’¬ Telegram,no-resolve
  - GEOSITE,twitter,ğ• Twitter
  - GEOIP,twitter,ğ• Twitter,no-resolve
  - GEOSITE,nintendo,ğŸ® Nintendo
  - GEOSITE,youtube,ğŸ¥ Youtube
  - GEOSITE,netflix,ğŸ¥ Netflix
  - GEOIP,netflix,ğŸ¥ Netflix,no-resolve
  - GEOSITE,apple-tvplus,ğŸ¥ Apple TV
  - GEOSITE,bahamut,ğŸ‡¹ğŸ‡¼ å°æ¹¾ä¼˜é€‰
  - GEOSITE,tiktok,ğŸ¥ TikTok
  - GEOSITE,category-emby,ğŸ¥ Emby Providers
  - GEOSITE,spotify,ğŸµ Spotify
  - RULE-SET,Qobuz,ğŸµ Qobuz
  # 6. main: p3
  - RULE-SET,RestrictedZones,ğŸˆ² Restricted
  - GEOSITE,category-games-!cn,ğŸ® Games
  - GEOSITE,category-dev,ğŸ’» Developer
  - GEOSITE,category-ai-!cn,âœ¨ GenAI
  - RULE-SET,GenAIExtra,âœ¨ GenAI
  - GEOSITE,category-cryptocurrency,ğŸ’° Crypto
  - RULE-SET,CryptoExtra,ğŸ’° Crypto
  - RULE-SET,HongKongBank,ğŸ¦ Banking HK
  # 7. main: p4
  - GEOSITE,microsoft,â“‚ï¸ Microsoft
  - GEOSITE,google,ğŸ­ Google
  - GEOIP,google,ğŸ­ Google,no-resolve
  - GEOSITE,apple,ğŸ Apple
  # 8. final
  - GEOSITE,cn,ğŸ¯ å…¨éƒ¨ç›´è¿
  - GEOSITE,geolocation-!cn,ğŸ”° èŠ‚ç‚¹é€‰æ‹©
  - GEOIP,cn,ğŸ¯ å…¨éƒ¨ç›´è¿,no-resolve
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼
